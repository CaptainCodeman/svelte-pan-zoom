import{S as W,i as X,s as j,I as Q,a as q,k as P,q as A,c as B,l as E,m as I,r as H,h as _,n as Y,b as M,G as k,J as ee,B as m,K as te}from"../../chunks/index-f169df10.js";const N=(e,n)=>Math.hypot(e.x-n.x,e.y-n.y),U=(e,n)=>({x:(e.x+n.x)/2,y:(e.y+n.y)/2}),V=(e,n)=>({x:e.x-n.x,y:e.y-n.y});function oe(e,n){const i=window.devicePixelRatio,o=e.getContext("2d");let r,p,f,y,s,l,c=e.width=e.clientWidth*i,x=e.height=e.clientHeight*i;function b(t){({width:p,height:f,render:y,padding:s,maxZoom:l}={padding:0,maxZoom:16,...t}),r=Math.min(e.width/(p+s*i),e.height/(f+s*i)),o.resetTransform(),o.translate(e.width/2,e.height/2),o.scale(r,r),o.translate(-p/2,-f/2)}b(n);const C=new ResizeObserver(t=>{const h=t[0].contentRect,a=g(new DOMPoint(c/2,x/2)),d=o.getTransform();c=h.width*i,x=h.height*i,e.width=c,e.height=x,r=Math.min(e.width/(n.width+s*i),e.height/(n.height+s*i)),o.setTransform(d);const u=g(new DOMPoint(e.width/2,e.height/2));o.translate(u.x-a.x,u.y-a.y),L()});C.observe(e);const w=new Map;function S(t){t.stopPropagation(),e.setPointerCapture(t.pointerId);const h=z(t);w.set(t.pointerId,h)}function v(t){t.stopPropagation(),e.releasePointerCapture(t.pointerId),w.delete(t.pointerId)}function T(t){if(t.stopPropagation(),!w.has(t.pointerId))return;const h=z(t);switch(w.size){case 1:{const a=w.get(t.pointerId),d=V(g(h),g(a));O(d),L(),w.set(t.pointerId,h);break}case 2:{let a=[...w.values()],d=g(a[0]),u=g(a[1]);const $=U(d,u),F=N(d,u);w.set(t.pointerId,h),a=[...w.values()],d=g(a[0]),u=g(a[1]);const R=U(d,u),G=N(d,u),J=V(R,$);O(J);const K=G/F;Z(R,K);break}}}function D(t){t.preventDefault(),t.stopPropagation();const h=z(t),a=Math.exp(-t.deltaY/512);Z(g(h),a)}function O(t){o.translate(t.x,t.y)}function Z(t,h){function a(u){o.translate(t.x,t.y),o.scale(u,u),o.translate(-t.x,-t.y)}a(h);const d=o.getTransform();d.a<r&&a(r/d.a),d.a>l&&a(l/d.a),L()}function z(t){return new DOMPoint(t.offsetX*i,t.offsetY*i)}function g(t){return o.getTransform().inverse().transformPoint(t)}function L(){o.save(),o.resetTransform(),o.clearRect(0,0,e.width,e.height),o.restore(),y(o)}return e.addEventListener("pointerdown",S,{passive:!0}),e.addEventListener("pointerup",v,{passive:!0}),e.addEventListener("pointercancel",v,{passive:!0}),e.addEventListener("pointermove",T,{passive:!0}),e.addEventListener("wheel",D),{update(t){b(t)},destroy(){C.unobserve(e),e.removeEventListener("pointerdown",S),e.removeEventListener("pointerup",v),e.removeEventListener("pointercancel",v),e.removeEventListener("pointermove",T),e.removeEventListener("wheel",D)}}}function ne(e){return{c:m,l:m,m,p:m,d:m}}function ie(e){let n,i,o;return{c(){n=P("canvas"),this.h()},l(r){n=E(r,"CANVAS",{class:!0}),I(n).forEach(_),this.h()},h(){Y(n,"class","svelte-1vuuih2")},m(r,p){M(r,n,p),i||(o=te(oe.call(null,n,e[1])),i=!0)},p(r,p){e=r},d(r){r&&_(n),i=!1,o()}}}function re(e){return{c:m,l:m,m,p:m,d:m}}function se(e){let n,i,o,r,p,f,y,s={ctx:e,current:null,token:null,hasCatch:!1,pending:re,then:ie,catch:ne,value:1};return Q(e[0],s),{c(){s.block.c(),n=q(),i=P("div"),o=P("h1"),r=A("Svelte Pan Zoom"),p=q(),f=P("p"),y=A("Use swipe & pinch touch gestures or mouse click+drag & wheel to pan and zoom image"),this.h()},l(l){s.block.l(l),n=B(l),i=E(l,"DIV",{class:!0});var c=I(i);o=E(c,"H1",{});var x=I(o);r=H(x,"Svelte Pan Zoom"),x.forEach(_),p=B(c),f=E(c,"P",{});var b=I(f);y=H(b,"Use swipe & pinch touch gestures or mouse click+drag & wheel to pan and zoom image"),b.forEach(_),c.forEach(_),this.h()},h(){Y(i,"class","svelte-1vuuih2")},m(l,c){s.block.m(l,s.anchor=c),s.mount=()=>n.parentNode,s.anchor=n,M(l,n,c),M(l,i,c),k(i,o),k(o,r),k(i,p),k(i,f),k(f,y)},p(l,[c]){e=l,ee(s,e,c)},i:m,o:m,d(l){s.block.d(l),s.token=null,s=null,l&&_(n),l&&_(i)}}}function le(e){return[new Promise(i=>{const o=new Image;o.onload=()=>i({width:o.width,height:o.height,render:r}),o.src="./svelte-kit-machine.webp";function r(p){p.drawImage(o,0,0)}})]}class ce extends W{constructor(n){super(),X(this,n,le,se,j,{})}}export{ce as default};
