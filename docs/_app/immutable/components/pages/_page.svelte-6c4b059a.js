import{S as Q,i as ee,s as te,I as ne,a as U,k as I,q as V,c as Y,l as z,m as L,r as $,h as w,n as K,b as S,G as v,J as oe,B as h,K as ie}from"../../chunks/index-f169df10.js";const F=(e,o)=>Math.hypot(e.x-o.x,e.y-o.y),G=(e,o)=>({x:(e.x+o.x)/2,y:(e.y+o.y)/2}),J=(e,o)=>({x:e.x-o.x,y:e.y-o.y});function re(e,o){const i=window.devicePixelRatio,n=e.getContext("2d");let r,p,u,x,s,a,d=e.width=e.clientWidth*i,y=e.height=e.clientHeight*i;function b(t){({width:p,height:u,render:x,padding:s,maxZoom:a}={padding:0,maxZoom:16,...t}),r=Math.min(e.width/(p+s*i),e.height/(u+s*i)),n.resetTransform(),n.translate(e.width/2,e.height/2),n.scale(r,r),n.translate(-p/2,-u/2)}b(o);const T=new ResizeObserver(t=>{const c=t[0].contentRect,l=g(new DOMPoint(d/2,y/2)),m=n.getTransform();d=c.width*i,y=c.height*i,e.width=d,e.height=y,r=Math.min(e.width/(o.width+s*i),e.height/(o.height+s*i)),n.setTransform(m);const _=g(new DOMPoint(e.width/2,e.height/2));n.translate(_.x-l.x,_.y-l.y),C()});T.observe(e);const f=new Map;function D(t){t.stopPropagation(),e.setPointerCapture(t.pointerId);const c=M(t);f.set(t.pointerId,c)}function k(t){t.stopPropagation(),e.releasePointerCapture(t.pointerId),f.delete(t.pointerId)}function O(t){if(t.stopPropagation(),!f.has(t.pointerId))return;const c=M(t);switch(f.size){case 1:{const l=f.get(t.pointerId),m=J(g(c),g(l));R(m),C(),f.set(t.pointerId,c);break}case 2:{const l=[...f.values()],m=g(l[0]),_=g(l[1]),P=G(m,_),E=F(m,_);f.set(t.pointerId,c);const A=[...f.values()],B=g(A[0]),H=g(A[1]),N=G(B,H),W=F(B,H),X=J(N,P);R(X);const j=W/E;q(N,j);break}}}function Z(t){t.preventDefault(),t.stopPropagation();const c=M(t),l=Math.exp(-t.deltaY/512);q(g(c),l)}function R(t){n.translate(t.x,t.y)}function q(t,c){function l(E){n.translate(t.x,t.y),n.scale(E,E),n.translate(-t.x,-t.y)}l(c);const m=n.getTransform(),_=r,P=a;m.a<_&&l(_/m.a),m.a>P&&l(P/m.a),C()}function M(t){const c=t.offsetX*i,l=t.offsetY*i;return new DOMPoint(c,l)}function g(t){return n.getTransform().inverse().transformPoint(t)}function C(){n.save(),n.resetTransform(),n.clearRect(0,0,e.width,e.height),n.restore(),x(n)}return e.addEventListener("pointerdown",D,{passive:!0}),e.addEventListener("pointerup",k,{passive:!0}),e.addEventListener("pointercancel",k,{passive:!0}),e.addEventListener("pointermove",O,{passive:!0}),e.addEventListener("wheel",Z),{update(t){b(t)},destroy(){T.unobserve(e),e.removeEventListener("pointerdown",D),e.removeEventListener("pointerup",k),e.removeEventListener("pointercancel",k),e.removeEventListener("pointermove",O),e.removeEventListener("wheel",Z)}}}function se(e){return{c:h,l:h,m:h,p:h,d:h}}function ae(e){let o,i,n;return{c(){o=I("canvas"),this.h()},l(r){o=z(r,"CANVAS",{class:!0}),L(o).forEach(w),this.h()},h(){K(o,"class","svelte-1ncaztn")},m(r,p){S(r,o,p),i||(n=ie(re.call(null,o,e[1])),i=!0)},p(r,p){e=r},d(r){r&&w(o),i=!1,n()}}}function ce(e){return{c:h,l:h,m:h,p:h,d:h}}function le(e){let o,i,n,r,p,u,x,s={ctx:e,current:null,token:null,hasCatch:!1,pending:ce,then:ae,catch:se,value:1};return ne(e[0],s),{c(){s.block.c(),o=U(),i=I("div"),n=I("h1"),r=V("Svelte Pan Zoom"),p=U(),u=I("p"),x=V("Use swipe & pinch touch gestures or mouse click+drag & wheel to pan and zoom image"),this.h()},l(a){s.block.l(a),o=Y(a),i=z(a,"DIV",{class:!0});var d=L(i);n=z(d,"H1",{});var y=L(n);r=$(y,"Svelte Pan Zoom"),y.forEach(w),p=Y(d),u=z(d,"P",{});var b=L(u);x=$(b,"Use swipe & pinch touch gestures or mouse click+drag & wheel to pan and zoom image"),b.forEach(w),d.forEach(w),this.h()},h(){K(i,"class","svelte-1ncaztn")},m(a,d){s.block.m(a,s.anchor=d),s.mount=()=>o.parentNode,s.anchor=o,S(a,o,d),S(a,i,d),v(i,n),v(n,r),v(i,p),v(i,u),v(u,x)},p(a,[d]){e=a,oe(s,e,d)},i:h,o:h,d(a){s.block.d(a),s.token=null,s=null,a&&w(o),a&&w(i)}}}function de(e){return[new Promise(i=>{const n=new Image;n.onload=()=>i({width:n.width,height:n.height,render:r}),n.src="./svelte-kit-machine.png";function r(p){p.drawImage(n,0,0)}})]}class he extends Q{constructor(o){super(),ee(this,o,de,le,te,{})}}export{he as default};
