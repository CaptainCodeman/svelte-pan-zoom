import{S as Q,i as ee,s as te,I as oe,a as U,k as I,q as V,c as Y,l as z,m as L,r as $,h as w,n as K,b as S,G as b,J as ne,B as p,K as ie}from"../../chunks/index-f169df10.js";const F=(e,n)=>Math.hypot(e.x-n.x,e.y-n.y),G=(e,n)=>({x:(e.x+n.x)/2,y:(e.y+n.y)/2}),J=(e,n)=>({x:e.x-n.x,y:e.y-n.y});function re(e,n){const i=window.devicePixelRatio,o=e.getContext("2d");let r,h,u,x,s,l,d=e.width=e.clientWidth*i,y=e.height=e.clientHeight*i;function v(t){({width:h,height:u,render:x,padding:s,maxZoom:l}={padding:0,maxZoom:16,...t}),r=Math.min(e.width/(h+s*i),e.height/(u+s*i)),o.resetTransform(),o.translate(e.width/2,e.height/2),o.scale(r,r),o.translate(-h/2,-u/2)}v(n);const T=new ResizeObserver(t=>{const a=t[0].contentRect,c=g(new DOMPoint(d/2,y/2)),m=o.getTransform();d=a.width*i,y=a.height*i,e.width=d,e.height=y,r=Math.min(e.width/(n.width+s*i),e.height/(n.height+s*i)),o.setTransform(m);const _=g(new DOMPoint(e.width/2,e.height/2));o.translate(_.x-c.x,_.y-c.y),C()});T.observe(e);const f=new Map;function D(t){t.stopPropagation(),e.setPointerCapture(t.pointerId);const a=M(t);f.set(t.pointerId,a)}function k(t){t.stopPropagation(),e.releasePointerCapture(t.pointerId),f.delete(t.pointerId)}function O(t){if(t.stopPropagation(),!f.has(t.pointerId))return;const a=M(t);switch(f.size){case 1:{const c=f.get(t.pointerId),m=J(g(a),g(c));R(m),C(),f.set(t.pointerId,a);break}case 2:{const c=[...f.values()],m=g(c[0]),_=g(c[1]),P=G(m,_),E=F(m,_);f.set(t.pointerId,a);const A=[...f.values()],B=g(A[0]),H=g(A[1]),N=G(B,H),W=F(B,H),X=J(N,P);R(X);const j=W/E;q(N,j);break}}}function Z(t){t.preventDefault(),t.stopPropagation();const a=M(t),c=Math.exp(-t.deltaY/512);q(g(a),c)}function R(t){o.translate(t.x,t.y)}function q(t,a){function c(E){o.translate(t.x,t.y),o.scale(E,E),o.translate(-t.x,-t.y)}c(a);const m=o.getTransform(),_=r,P=l;m.a<_&&c(_/m.a),m.a>P&&c(P/m.a),C()}function M(t){const a=t.offsetX*i,c=t.offsetY*i;return new DOMPoint(a,c)}function g(t){return o.getTransform().inverse().transformPoint(t)}function C(){o.save(),o.resetTransform(),o.clearRect(0,0,e.width,e.height),o.restore(),x(o)}return e.addEventListener("pointerdown",D,{passive:!0}),e.addEventListener("pointerup",k,{passive:!0}),e.addEventListener("pointercancel",k,{passive:!0}),e.addEventListener("pointermove",O,{passive:!0}),e.addEventListener("wheel",Z),{update(t){v(t)},destroy(){T.unobserve(e),e.removeEventListener("pointerdown",D),e.removeEventListener("pointerup",k),e.removeEventListener("pointercancel",k),e.removeEventListener("pointermove",O),e.removeEventListener("wheel",Z)}}}function se(e){return{c:p,l:p,m:p,p,d:p}}function le(e){let n,i,o;return{c(){n=I("canvas"),this.h()},l(r){n=z(r,"CANVAS",{class:!0}),L(n).forEach(w),this.h()},h(){K(n,"class","svelte-1vuuih2")},m(r,h){S(r,n,h),i||(o=ie(re.call(null,n,e[1])),i=!0)},p(r,h){e=r},d(r){r&&w(n),i=!1,o()}}}function ae(e){return{c:p,l:p,m:p,p,d:p}}function ce(e){let n,i,o,r,h,u,x,s={ctx:e,current:null,token:null,hasCatch:!1,pending:ae,then:le,catch:se,value:1};return oe(e[0],s),{c(){s.block.c(),n=U(),i=I("div"),o=I("h1"),r=V("Svelte Pan Zoom"),h=U(),u=I("p"),x=V("Use swipe & pinch touch gestures or mouse click+drag & wheel to pan and zoom image"),this.h()},l(l){s.block.l(l),n=Y(l),i=z(l,"DIV",{class:!0});var d=L(i);o=z(d,"H1",{});var y=L(o);r=$(y,"Svelte Pan Zoom"),y.forEach(w),h=Y(d),u=z(d,"P",{});var v=L(u);x=$(v,"Use swipe & pinch touch gestures or mouse click+drag & wheel to pan and zoom image"),v.forEach(w),d.forEach(w),this.h()},h(){K(i,"class","svelte-1vuuih2")},m(l,d){s.block.m(l,s.anchor=d),s.mount=()=>n.parentNode,s.anchor=n,S(l,n,d),S(l,i,d),b(i,o),b(o,r),b(i,h),b(i,u),b(u,x)},p(l,[d]){e=l,ne(s,e,d)},i:p,o:p,d(l){s.block.d(l),s.token=null,s=null,l&&w(n),l&&w(i)}}}function de(e){return[new Promise(i=>{const o=new Image;o.onload=()=>i({width:o.width,height:o.height,render:r}),o.src="./svelte-kit-machine.png";function r(h){h.drawImage(o,0,0)}})]}class pe extends Q{constructor(n){super(),ee(this,n,de,ce,te,{})}}export{pe as default};
