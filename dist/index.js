var W=(e,r)=>Math.hypot(e.x-r.x,e.y-r.y),k=(e,r)=>({x:(e.x+r.x)/2,y:(e.y+r.y)/2}),H=(e,r)=>({x:e.x-r.x,y:e.y-r.y});function S(e,r){let d=window.devicePixelRatio,n=e.getContext("2d"),c,w,g,b,u,D,x=e.width=e.clientWidth*d,a=e.height=e.clientHeight*d;function y(t){({width:w,height:g,render:b,padding:u,maxZoom:D}={padding:0,maxZoom:16,...t}),c=Math.min(e.width/(w+u*d),e.height/(g+u*d)),n.resetTransform(),n.translate(e.width/2,e.height/2),n.scale(c,c),n.translate(-w/2,-g/2)}y(r);let E=new ResizeObserver(t=>{let o=t[0].contentRect,i=m(new DOMPoint(x/2,a/2)),s=n.getTransform();x=o.width*d,a=o.height*d,e.width=x,e.height=a,c=Math.min(e.width/(r.width+u*d),e.height/(r.height+u*d)),n.setTransform(s);let h=m(new DOMPoint(e.width/2,e.height/2));n.translate(h.x-i.x,h.y-i.y),O()});E.observe(e);let p=new Map;function L(t){t.stopPropagation(),e.setPointerCapture(t.pointerId);let o=M(t);p.set(t.pointerId,o)}function l(t){t.stopPropagation(),e.releasePointerCapture(t.pointerId),p.delete(t.pointerId)}function _(t){if(t.stopPropagation(),!p.has(t.pointerId))return;let o=M(t);switch(p.size){case 1:{let i=p.get(t.pointerId),s=H(m(o),m(i));I(s),O(),p.set(t.pointerId,o);break}case 2:{let i=[...p.values()],s=m(i[0]),h=m(i[1]),f=k(s,h),P=W(s,h);p.set(t.pointerId,o);let R=[...p.values()],T=m(R[0]),C=m(R[1]),Z=k(T,C),Y=W(T,C),B=H(Z,f);I(B);let F=Y/P;z(Z,F);break}}}function v(t){t.preventDefault(),t.stopPropagation();let o=M(t),i=Math.exp(-t.deltaY/512);z(m(o),i)}function I(t){n.translate(t.x,t.y)}function z(t,o){function i(P){n.translate(t.x,t.y),n.scale(P,P),n.translate(-t.x,-t.y)}i(o);let s=n.getTransform(),h=c,f=D;s.a<h&&i(h/s.a),s.a>f&&i(f/s.a),O()}function M(t){let o=t.offsetX*d,i=t.offsetY*d;return new DOMPoint(o,i)}function m(t){return n.getTransform().inverse().transformPoint(t)}function O(){n.save(),n.resetTransform(),n.clearRect(0,0,e.width,e.height),n.restore(),b(n)}return e.addEventListener("pointerdown",L,{passive:!0}),e.addEventListener("pointerup",l,{passive:!0}),e.addEventListener("pointercancel",l,{passive:!0}),e.addEventListener("pointermove",_,{passive:!0}),e.addEventListener("wheel",v),{update(t){y(t)},destroy(){E.unobserve(e),e.removeEventListener("pointerdown",L),e.removeEventListener("pointerup",l),e.removeEventListener("pointercancel",l),e.removeEventListener("pointermove",_),e.removeEventListener("wheel",v)}}}export{S as panzoom};
//# sourceMappingURL=index.js.map