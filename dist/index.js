var T=(e,s)=>Math.hypot(e.x-s.x,e.y-s.y),v=(e,s)=>({x:(e.x+s.x)/2,y:(e.y+s.y)/2}),C=(e,s)=>({x:e.x-s.x,y:e.y-s.y});function Y(e,s){let p=window.devicePixelRatio,n=e.getContext("2d"),u,c,P,O,l,w,g=e.width=e.clientWidth*p,x=e.height=e.clientHeight*p;function b(t){({width:c,height:P,render:O,padding:l,maxZoom:w}={padding:0,maxZoom:16,...t}),u=Math.min(e.width/(c+l*p),e.height/(P+l*p)),n.resetTransform(),n.translate(e.width/2,e.height/2),n.scale(u,u),n.translate(-c/2,-P/2)}b(s);let D=new ResizeObserver(t=>{let r=t[0].contentRect,o=h(new DOMPoint(g/2,x/2)),i=n.getTransform();g=r.width*p,x=r.height*p,e.width=g,e.height=x,u=Math.min(e.width/(s.width+l*p),e.height/(s.height+l*p)),n.setTransform(i);let d=h(new DOMPoint(e.width/2,e.height/2));n.translate(d.x-o.x,d.y-o.y),M()});D.observe(e);let m=new Map;function E(t){t.stopPropagation(),e.setPointerCapture(t.pointerId);let r=a(t);m.set(t.pointerId,r)}function f(t){t.stopPropagation(),e.releasePointerCapture(t.pointerId),m.delete(t.pointerId)}function y(t){if(t.stopPropagation(),!m.has(t.pointerId))return;let r=a(t);switch(m.size){case 1:{let o=m.get(t.pointerId),i=C(h(r),h(o));I(i),M(),m.set(t.pointerId,r);break}case 2:{let o=[...m.values()],i=h(o[0]),d=h(o[1]),_=v(i,d),Z=T(i,d);m.set(t.pointerId,r),o=[...m.values()],i=h(o[0]),d=h(o[1]);let R=v(i,d),W=T(i,d),k=C(R,_);I(k);let H=W/Z;z(R,H);break}}}function L(t){t.preventDefault(),t.stopPropagation();let r=a(t),o=Math.exp(-t.deltaY/512);z(h(r),o)}function I(t){n.translate(t.x,t.y)}function z(t,r){function o(d){n.translate(t.x,t.y),n.scale(d,d),n.translate(-t.x,-t.y)}o(r);let i=n.getTransform();i.a<u&&o(u/i.a),i.a>w&&o(w/i.a),M()}function a(t){return new DOMPoint(t.offsetX*p,t.offsetY*p)}function h(t){return n.getTransform().inverse().transformPoint(t)}function M(){n.save(),n.resetTransform(),n.clearRect(0,0,e.width,e.height),n.restore(),O(n)}return e.addEventListener("pointerdown",E,{passive:!0}),e.addEventListener("pointerup",f,{passive:!0}),e.addEventListener("pointercancel",f,{passive:!0}),e.addEventListener("pointermove",y,{passive:!0}),e.addEventListener("wheel",L),{update(t){b(t)},destroy(){D.unobserve(e),e.removeEventListener("pointerdown",E),e.removeEventListener("pointerup",f),e.removeEventListener("pointercancel",f),e.removeEventListener("pointermove",y),e.removeEventListener("wheel",L)}}}export{Y as panzoom};
//# sourceMappingURL=index.js.map